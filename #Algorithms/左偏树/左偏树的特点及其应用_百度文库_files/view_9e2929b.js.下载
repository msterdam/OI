define("wkview:widget/kg_recommend/view/view.js",function(e,t){var i=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkview:widget/ui/html_view/widget.js"),o=(e("wkcommon:widget/ui/lib/page/page.js"),n.widget),s=e("wkview:widget/kg_recommend/view/statistic.js").Statistic,r=e("wkcommon:widget/ui/lib/jquery/jquery.js"),d=e("wkcommon:widget/lib/doT/doT.min.js"),c=(e("wkcommon:widget/ui/js_core/log/log.js"),e("wkview:widget/kg_recommend/component/tab/tab.js").Tab),a=e("wkview:widget/kg_recommend/component/kgtree/kgtree.js").KGTree,l=e("wkview:widget/kg_recommend/component/doclist/doclist.js").Doclist,m={kgPadding:24,kgTreeWrapWidth:350,kgTreeWrapMr:30},g=o({Options:{},elements:{".kgrec-container":"$kgrecContainer",".kgdocs-wrap":"$kgdocsWrap",".text-node-temp .text-node":"$tempTextNode",".kgtree-content":"$kgtreeContent"},_init:function(){this.Mediator=this.options.Mediator,this.tpl=d.template('<div class=\'mod kgrec-container pt20\'>\n<div class="hd kg-hd">\u76f8\u5173\u77e5\u8bc6</div>\n<div class="bd kg-bd">\n<div class="tab-items">\n<ul class="tab-items-wrap clearfix">\n</ul>\n</div>\n<div class="tab-content clearfix">\n<div class="kgtree-wrap">\n<div class="kgtree-content"></div>\n<div class="arrow"></div>\n</div>\n<div class="kgdocs-wrap"></div>\n</div>\n</div>\n</div>\n<div class="text-node-temp">\n<a class="text-wrap">\n<span class="text-node"></span>\n</a>\n</div>\n')},_initEvents:function(){var e=this;e.on("onload",function(){i.lang.eventCenter.addEventListener("Reader.zoomChange",r.proxy(e._resize,e))}),e.on("onload",function(){function t(){var t=e.$el.offset().top,n=e.$el.height(),o=r(window).height(),s=r(window).scrollTop();s+o>=t+n&&(i||e.fire("moduleShow"),i=!0)}var i=!1;r(window).on("scroll.kgrecommend",t),t()}),e.on("ondispose",function(){}),e.Mediator.on("v:initFirstKGInfo",function(t){e.$elements.$kgrecContainer.show(),e.tabItems=t.items||[],e.cardItems=t.carditems||[],e.doclist=t.doclist||{},e._createTabItems(),e._createKGTree(e.cardItems[0]),e._ceatDoclist({doclist:e.doclist,curent:{ent_uuid:e.cardItems[0].ent_uuid,ent_name:e.cardItems[0].ent_name}})}),e.Mediator.on("v:refreshKGTreeDoclist",function(t){e._refreshKGTreeDoclist(t)}),e.Mediator.on("v:refreshWholeDoclist",function(t){e._refreshWholeDoclist(t)})},_render:function(){var e=this;this.$el.html(e.tpl())},_createTabItems:function(){var e=this;this.tabItemComp=new c({el:".tab-items-wrap",Mediator:e.Mediator,data:e.tabItems})},_createKGTree:function(e){var t=this;e&&(r.isEmptyObject(e)||(t.KGTree=new a({el:".kgtree-content",Mediator:t.Mediator,tempTextNode:t.$elements.$tempTextNode,data:e})))},_calDoclistWidth:function(){var e=r(".reader-container").width();this.$elements.$kgdocsWrap.width(e-2*m.kgPadding-m.kgTreeWrapWidth-m.kgTreeWrapMr)},_resize:function(){var e=this;this._calDoclistWidth(),this.Doclist&&this.Doclist.resize({kgdocsWrapW:e.$elements.$kgdocsWrap.width()})},_ceatDoclist:function(e){var t=this;t.Doclist&&t.Doclist.fire("ondispose"),t.Doclist=new l({el:".kgdocs-wrap",Mediator:t.Mediator,data:e})},_refreshKGTreeDoclist:function(e){var t=this;t.cardItems=e.carditems||{},t.doclist=e.doclist||[],t._createKGTree(t.cardItems),t.$elements.$kgdocsWrap.html(""),t._ceatDoclist({doclist:t.doclist,curent:{ent_uuid:t.cardItems.ent_uuid,ent_name:t.cardItems.ent_name}})},_refreshWholeDoclist:function(e){var t=this,i=e.curNode;t.doclist=e.doclist||[],t.$elements.$kgdocsWrap.html(""),t._ceatDoclist({doclist:t.doclist,curent:{ent_uuid:i.ent_uuid,ent_name:i.ent_name}})}});n.register(g,s,s.prototype),t.View=g});